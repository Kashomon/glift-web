/*
 Glift: A Responsive Javascript library for the game Go.

 @version 1.0.1
 @copyright Josh Hoak
 @license MIT License (see LICENSE.txt)
 --------------------------------------
 FastClick: polyfill to remove click delays on browsers with touch UIs.

 @version 0.6.11
 @codingstandard ftlabs-jsv2
 @copyright The Financial Times Limited [All Rights Reserved]
 @license MIT License (see LICENSE.txt)
*/
(function(){var a=window.glift||{};a.global={fastClickEnabled:!1,enableFastClick:function(){a.global.fastClickEnabled||(FastClick.attach(document.body),a.global.fastClickEnabled=!0)},debugMode:!1,performanceDebug:!1,version:"1.0.1",active:{}};window.glift=a})();
glift.util={logz:function(a){var c=a;if("array"===glift.util.typeOf(a)||"object"===glift.util.typeOf(a))c=JSON.stringify(a);console.log(""+c);return glift.util.none},beget:function(a){var c=function(){};c.prototype=a;return new c},typeOf:function(a){var c=typeof a;"object"===c&&(a?a instanceof Array&&(c="array"):c="null");return c},isArray:function(a){return a&&"object"===typeof a&&a.constructor===Array},inBounds:function(a,c){return a<c&&0<=a},outBounds:function(a,c){return a>=c||0>a},intersection:function(a,
c){var b={},d;for(d in a)void 0!==c[d]&&(b[d]=1);return b},getKeyWithDefault:function(a,c,b){void 0===a[c]&&(a[c]=b);return a[c]},sizeOf:function(a){var c=0,b;for(b in a)c+=1;return c},setMethods:function(a,c){for(var b in c)a[b]=c[b].bind(a);return a}};glift.util.debugl=function(a){glift.debugOn&&glift.util.log(a)};glift.util.log=function(a){("array"===glift.util.typeOf(a)||"object"===glift.util.typeOf(a))&&JSON.stringify(a);void 0!==console&&void 0!==console.log&&console.log(a)};
(function(){var a=function(){this.type="none"};a.prototype={toString:function(){return"None"}};glift.util.none=new a})();glift.util.colors={isLegalColor:function(a){return a===glift.enums.states.BLACK||a===glift.enums.states.WHITE||a===glift.enums.states.EMPTY},oppositeColor:function(a){return a===glift.enums.states.BLACK?glift.enums.states.WHITE:a===glift.enums.states.WHITE?glift.enums.states.BLACK:a}};
glift.enums={states:{BLACK:"BLACK",WHITE:"WHITE",EMPTY:"EMPTY"},directions:{LEFT:"LEFT",RIGHT:"RIGHT",TOP:"TOP",BOTTOM:"BOTTOM"},controllerMessages:{CONTINUE:"CONTINUE",DONE:"DONE",FAILURE:"FAILURE"},boardRegions:{LEFT:"LEFT",RIGHT:"RIGHT",TOP:"TOP",BOTTOM:"BOTTOM",TOP_LEFT:"TOP_LEFT",TOP_RIGHT:"TOP_RIGHT",BOTTOM_LEFT:"BOTTOM_LEFT",BOTTOM_RIGHT:"BOTTOM_RIGHT",ALL:"ALL",AUTO:"AUTO"},marks:{CIRCLE:"CIRCLE",SQUARE:"SQUARE",TRIANGLE:"TRIANGLE",XMARK:"XMARK",STONE_MARKER:"STONE_MARKER",LABEL:"LABEL",VARIATION_MARKER:"VARIATION_MARKER",
CORRECT_VARIATION:"CORRECT_VARIATION"},problemResults:{CORRECT:"CORRECT",INCORRECT:"INCORRECT",INDETERMINATE:"INDETERMINATE",FAILURE:"FAILURE"},displayDataTypes:{PARTIAL:"PARTIAL",FULL:"FULL"},svgElements:{BOARD_BASE:"board_base",BOARD_LINE:"board_line",BUTTON:"button",MARK:"mark",MARK_CONTAINER:"mark_container",GLIFT_ELEMENT:"glift_element",STARPOINT:"starpoint",STONE:"stone",STONE_SHADOW:"stone_shadow",ICON:"icon"},showVariations:{ALWAYS:"ALWAYS",NEVER:"NEVER",MORE_THAN_ONE:"MORE_THAN_ONE"}};
(function(){glift.errors={};glift.errors.ParseError=function(a){this.name="ParseError";this.message=a||""};glift.errors.ParseError.prototype=Error()})();
function FastClick(a){var c,b=this;this.trackingClick=!1;this.trackingClickStart=0;this.targetElement=null;this.lastTouchIdentifier=this.touchStartY=this.touchStartX=0;this.touchBoundary=10;this.layer=a;if(!a||!a.nodeType)throw new TypeError("Layer must be a document node");this.onClick=function(){return FastClick.prototype.onClick.apply(b,arguments)};this.onMouse=function(){return FastClick.prototype.onMouse.apply(b,arguments)};this.onTouchStart=function(){return FastClick.prototype.onTouchStart.apply(b,
arguments)};this.onTouchMove=function(){return FastClick.prototype.onTouchMove.apply(b,arguments)};this.onTouchEnd=function(){return FastClick.prototype.onTouchEnd.apply(b,arguments)};this.onTouchCancel=function(){return FastClick.prototype.onTouchCancel.apply(b,arguments)};FastClick.notNeeded(a)||(this.deviceIsAndroid&&(a.addEventListener("mouseover",this.onMouse,!0),a.addEventListener("mousedown",this.onMouse,!0),a.addEventListener("mouseup",this.onMouse,!0)),a.addEventListener("click",this.onClick,
!0),a.addEventListener("touchstart",this.onTouchStart,!1),a.addEventListener("touchmove",this.onTouchMove,!1),a.addEventListener("touchend",this.onTouchEnd,!1),a.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(a.removeEventListener=function(c,b,f){var g=Node.prototype.removeEventListener;"click"===c?g.call(a,c,b.hijacked||b,f):g.call(a,c,b,f)},a.addEventListener=function(c,b,f){var g=Node.prototype.addEventListener;"click"===c?g.call(a,c,b.hijacked||
(b.hijacked=function(a){a.propagationStopped||b(a)}),f):g.call(a,c,b,f)}),"function"===typeof a.onclick&&(c=a.onclick,a.addEventListener("click",function(a){c(a)},!1),a.onclick=null))}FastClick.prototype.deviceIsAndroid=0<navigator.userAgent.indexOf("Android");FastClick.prototype.deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent);FastClick.prototype.deviceIsIOS4=FastClick.prototype.deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent);
FastClick.prototype.deviceIsIOSWithBadTarget=FastClick.prototype.deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(a){switch(a.nodeName.toLowerCase()){case "button":case "select":case "textarea":if(a.disabled)return!0;break;case "input":if(this.deviceIsIOS&&"file"===a.type||a.disabled)return!0;break;case "label":case "video":return!0}return/\bneedsclick\b/.test(a.className)};
FastClick.prototype.needsFocus=function(a){switch(a.nodeName.toLowerCase()){case "textarea":case "select":return!0;case "input":switch(a.type){case "button":case "checkbox":case "file":case "image":case "radio":case "submit":return!1}return!a.disabled&&!a.readOnly;default:return/\bneedsfocus\b/.test(a.className)}};
FastClick.prototype.sendClick=function(a,c){var b,d;document.activeElement&&document.activeElement!==a&&document.activeElement.blur();d=c.changedTouches[0];b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null);b.forwardedTouchEvent=!0;a.dispatchEvent(b)};
FastClick.prototype.focus=function(a){var c;this.deviceIsIOS&&a.setSelectionRange&&0!==a.type.indexOf("date")&&"time"!==a.type?(c=a.value.length,a.setSelectionRange(c,c)):a.focus()};FastClick.prototype.updateScrollParent=function(a){var c,b;c=a.fastClickScrollParent;if(!c||!c.contains(a)){b=a;do{if(b.scrollHeight>b.offsetHeight){c=b;a.fastClickScrollParent=b;break}b=b.parentElement}while(b)}c&&(c.fastClickLastScrollTop=c.scrollTop)};
FastClick.prototype.getTargetElementFromEventTarget=function(a){return a.nodeType===Node.TEXT_NODE?a.parentNode:a};
FastClick.prototype.onTouchStart=function(a){var c,b,d;if(1<a.targetTouches.length)return!0;c=this.getTargetElementFromEventTarget(a.target);b=a.targetTouches[0];if(this.deviceIsIOS){d=window.getSelection();if(d.rangeCount&&!d.isCollapsed)return!0;if(!this.deviceIsIOS4){if(b.identifier===this.lastTouchIdentifier)return a.preventDefault(),!1;this.lastTouchIdentifier=b.identifier;this.updateScrollParent(c)}}this.trackingClick=!0;this.trackingClickStart=a.timeStamp;this.targetElement=c;this.touchStartX=
b.pageX;this.touchStartY=b.pageY;200>a.timeStamp-this.lastClickTime&&a.preventDefault();return!0};FastClick.prototype.touchHasMoved=function(a){a=a.changedTouches[0];var c=this.touchBoundary;return Math.abs(a.pageX-this.touchStartX)>c||Math.abs(a.pageY-this.touchStartY)>c?!0:!1};FastClick.prototype.onTouchMove=function(a){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(a.target)||this.touchHasMoved(a))this.trackingClick=!1,this.targetElement=null;return!0};
FastClick.prototype.findControl=function(a){return void 0!==a.control?a.control:a.htmlFor?document.getElementById(a.htmlFor):a.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")};
FastClick.prototype.onTouchEnd=function(a){var c,b,d=this.targetElement;if(!this.trackingClick)return!0;if(200>a.timeStamp-this.lastClickTime)return this.cancelNextClick=!0;this.cancelNextClick=!1;this.lastClickTime=a.timeStamp;c=this.trackingClickStart;this.trackingClick=!1;this.trackingClickStart=0;this.deviceIsIOSWithBadTarget&&(b=a.changedTouches[0],d=document.elementFromPoint(b.pageX-window.pageXOffset,b.pageY-window.pageYOffset)||d,d.fastClickScrollParent=this.targetElement.fastClickScrollParent);
b=d.tagName.toLowerCase();if("label"===b){if(c=this.findControl(d)){this.focus(d);if(this.deviceIsAndroid)return!1;d=c}}else if(this.needsFocus(d)){if(100<a.timeStamp-c||this.deviceIsIOS&&window.top!==window&&"input"===b)return this.targetElement=null,!1;this.focus(d);if(!this.deviceIsIOS4||"select"!==b)this.targetElement=null,a.preventDefault();return!1}if(this.deviceIsIOS&&!this.deviceIsIOS4&&(c=d.fastClickScrollParent)&&c.fastClickLastScrollTop!==c.scrollTop)return!0;this.needsClick(d)||(a.preventDefault(),
this.sendClick(d,a));return!1};FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1;this.targetElement=null};FastClick.prototype.onMouse=function(a){return!this.targetElement||a.forwardedTouchEvent||!a.cancelable?!0:!this.needsClick(this.targetElement)||this.cancelNextClick?(a.stopImmediatePropagation?a.stopImmediatePropagation():a.propagationStopped=!0,a.stopPropagation(),a.preventDefault(),!1):!0};
FastClick.prototype.onClick=function(a){if(this.trackingClick)return this.targetElement=null,this.trackingClick=!1,!0;if("submit"===a.target.type&&0===a.detail)return!0;a=this.onMouse(a);a||(this.targetElement=null);return a};
FastClick.prototype.destroy=function(){var a=this.layer;this.deviceIsAndroid&&(a.removeEventListener("mouseover",this.onMouse,!0),a.removeEventListener("mousedown",this.onMouse,!0),a.removeEventListener("mouseup",this.onMouse,!0));a.removeEventListener("click",this.onClick,!0);a.removeEventListener("touchstart",this.onTouchStart,!1);a.removeEventListener("touchmove",this.onTouchMove,!1);a.removeEventListener("touchend",this.onTouchEnd,!1);a.removeEventListener("touchcancel",this.onTouchCancel,!1)};
FastClick.notNeeded=function(a){var c;if("undefined"===typeof window.ontouchstart)return!0;if(/Chrome\/[0-9]+/.test(navigator.userAgent))if(FastClick.prototype.deviceIsAndroid){if((c=document.querySelector("meta[name=viewport]"))&&-1!==c.content.indexOf("user-scalable=no"))return!0}else return!0;return"none"===a.style.msTouchAction?!0:!1};FastClick.attach=function(a){return new FastClick(a)};
"undefined"!==typeof define&&define.amd?define(function(){return FastClick}):"undefined"!==typeof module&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick;glift.util._IdGenerator=function(a){this.seed=a||0};glift.util._IdGenerator.prototype={next:function(){var a=this.seed+"";this.seed+=1;return a}};glift.util.idGenerator=new glift.util._IdGenerator(0);
glift.keyMappings={_nameToCode:{ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_:40,BACKSPACE:8,ENTER:13,SHIFT:16,FORWARD_SLASH:191,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75},nameToCode:function(a){return glift.keyMappings._nameToCode[a]},_codeToName:void 0,codeToName:function(a){if(void 0===glift.keyMappings._codeToName){var c={},b;for(b in glift.keyMappings._nameToCode)c[glift.keyMappings._nameToCode[b]]=b;glift.keyMappings._codeToName=c}return glift.keyMappings._codeToName[a]}};
glift.math={abs:function(a){return 0<=a?a:-1*a},max:function(a,c){return a>c?a:c},min:function(a,c){return a>c?c:a},isEven:function(a){return 0==a%2?!0:!1},getRandomInt:function(a,c){return Math.floor(Math.random()*(c-a+1))+a}};
(function(){glift.util.point=function(c,b){return new a(c,b)};glift.util.coordToString=function(a,b){return a+","+b};glift.util.pointFromString=function(a){try{var b=a.split(","),d=parseInt(b[0]),e=parseInt(b[1]);return glift.util.point(d,e)}catch(f){throw"Parsing Error! Couldn't parse a point from: "+a;}};glift.util.pointFromSgfCoord=function(a){if(2!=a.length)throw"Unknown SGF Coord length: "+a.length;return glift.util.point(a.charCodeAt(0)-97,a.charCodeAt(1)-97)};glift.util.pointFromHash=function(a){return glift.util.pointFromString(a)};
var a=function(a,b){this._x=a;this._y=b};a.prototype={x:function(){return this._x},y:function(){return this._y},equals:function(a){return this._x===a.x()&&this._y===a.y()},toSgfCoord:function(){return String.fromCharCode(this.x()+97)+String.fromCharCode(this.y()+97)},hash:function(){return this.toString()},toString:function(){return glift.util.coordToString(this.x(),this.y())},translate:function(a,b){return glift.util.point(this.x()+a,this.y()+b)},log:function(){glift.util.logz(this.toString())}}})();
glift.util.regions={getComponents:function(a){var c=glift.enums.boardRegions,b={};a===c.TOP_LEFT?(b[c.TOP]=1,b[c.LEFT]=1):a===c.TOP_RIGHT?(b[c.TOP]=1,b[c.RIGHT]=1):a===c.BOTTOM_LEFT?(b[c.BOTTOM]=1,b[c.LEFT]=1):a===c.BOTTOM_RIGHT&&(b[c.BOTTOM]=1,b[c.RIGHT]=1);return b}};
glift.testUtil={ptlistToMap:function(a){for(var c={},b=0;b<a.length;b++){var d=a[b];void 0!==d.value?c[d.point.hash()]=d:c[d.hash()]=d}return c},assertFullDiv:function(a){ok(0!==d3.selectAll("#"+a+" svg")[0].length,"Div should contain contents")},assertEmptyDiv:function(a){deepEqual(d3.selectAll("#"+a+" svg")[0].length,0,"Div should not contain contents")}};
glift.themes={registered:{},get:function(a){var c=glift.themes.registered;a=!(a in c)?glift.util.none:c[a];return a===glift.util.none?a:glift.themes.deepCopy({},a,c.DEFAULT)},deepCopy:function(a,c,b){for(var d in b){var e=glift.util.typeOf(b[d]),f=b;void 0!==c[d]&&(f=c);switch(e){case "object":a[d]=glift.themes.deepCopy({},c[d]||{},b[d]);break;case "array":for(var e={},f=[],g=b[d].concat(c[d]||[]),h=0;h<g.length;h++){var k=g[h];k in e||(f.push(k),e[k]=1)}a[d]=k;break;default:a[d]=f[d]}}return a},
has:function(a){return a in glift.themes.registered},setGoBoardBackground:function(a,c){if(a)a.board.imagefill=c;else throw"Yikes! Not a theme: cannot set background image.";}};
glift.themes.registered.DEFAULT={board:{fill:"#f5be7e",stroke:"#000000","stroke-width":1},starPoints:{sizeFraction:0.15,fill:"#000000"},lines:{stroke:"#000000","stroke-width":0.5},stones:{shadows:{stroke:"none",fill:"none"},marks:{"font-family":"sans-serif"},EMPTY:{fill:"blue",opacity:0,marks:{fill:"black",stroke:"black",VARIATION_MARKER:{stroke:"#A22",fill:"#A22"},CORRECT_VARIATION:{stroke:"#22D",fill:"#22D"}}},BLACK:{fill:"black",opacity:1,"stroke-width":1,stroke:"black",marks:{fill:"white",stroke:"white",
STONE_MARKER:{fill:"#CCF",opacity:0.6}}},BLACK_HOVER:{fill:"black",opacity:0.5},WHITE:{stroke:"black",fill:"white",opacity:1,"stroke-width":1,marks:{fill:"black",stroke:"black",STONE_MARKER:{fill:"#33F",opacity:0.6}}},WHITE_HOVER:{fill:"white",stroke:"black",opacity:0.5}},icons:{DEFAULT:{fill:"#0000AA",stroke:"black"},DEFAULT_HOVER:{fill:"cyan",stroke:"black"}},defs:{}};
glift.themes.registered.DEPTH={stones:{shadows:{stroke:"none",fill:"#555"},WHITE:{stroke:"white",fill:"white"},WHITE_HOVER:{fill:"white",stroke:"white",opacity:0.5}}};glift.themes.registered.MOODY={board:{fill:"#777777"},stones:{WHITE:{stroke:"white",fill:"white"},WHITE_HOVER:{fill:"white",stroke:"white",opacity:0.5}}};glift.themes.registered.TEXTBOOK={board:{fill:"#FFFFFF"}};glift.themes.registered.TRANSPARENT={board:{fill:"none"}};
glift.displays={create:function(a){var c=glift.displays.environment.get(a),b=a.theme||"DEFAULT",d=glift.themes.get(b);a.goBoardBackground&&""!==a.goBoardBackground&&glift.themes.setGoBoardBackground(d,a.goBoardBackground);return glift.displays.board.create(c,b,d)}};
(function(){glift.displays.bboxFromPts=function(c,b){return new a(c,b)};glift.displays.bboxFromDiv=function(a){return glift.displays.bbox(glift.util.point(0,0),$("#"+a).width(),$("#"+a).height())};glift.displays.bbox=function(c,b,d){return new a(c,glift.util.point(c.x()+b,c.y()+d))};var a=function(a,b){this._topLeftPt=a;this._botRightPt=b};a.prototype={topLeft:function(){return this._topLeftPt},botRight:function(){return this._botRightPt},width:function(){return this.botRight().x()-this.topLeft().x()},
height:function(){return this.botRight().y()-this.topLeft().y()},top:function(){return this.topLeft().y()},left:function(){return this.topLeft().x()},bottom:function(){return this.botRight().y()},right:function(){return this.botRight().x()},center:function(){return glift.util.point(glift.math.abs((this.botRight().x()-this.topLeft().x())/2)+this.topLeft().x(),glift.math.abs((this.botRight().y()-this.topLeft().y())/2)+this.topLeft().y())},draw:function(a,b){a.rect(this.topLeft().x(),this.topLeft().y(),
this.width(),this.height()).attr({fill:b,opacity:0.5})},log:function(){glift.util.logz("TopLeft: "+JSON.stringify(this.topLeft()));glift.util.logz("BotRight: "+JSON.stringify(this.botRight()));glift.util.logz("Width: "+this.width());glift.util.logz("Height: "+this.height())},contains:function(a){return a.x()>=this.topLeft().x()&&a.x()<=this.botRight().x()&&a.y()>=this.topLeft().y()&&a.y()<=this.botRight().y()},equals:function(a){return a.topLeft()&&this.topLeft().equals(a.topLeft())&&a.botRight()&&
this.botRight().equals(a.botRight())},scale:function(a){var b=this.height()*a,d=this.width()*a;a=glift.util.point(this.topLeft().x()*a,this.topLeft().y()*a);return glift.displays.bbox(a,d,b)},toString:function(){return this.topLeft().toString()+","+this.botRight().toString()},translate:function(a,b){return glift.displays.bboxFromPts(glift.util.point(this.topLeft().x()+a,this.topLeft().y()+b),glift.util.point(this.botRight().x()+a,this.botRight().y()+b))}}})();
(function(){glift.displays.boardPoints=function(c,b,d){return new a(c,b,d)};glift.displays.boardPointsFromLineBox=function(a,b){for(var d=a.spacing,e=d/2,f=a.bbox,g=f.left()+a.extensionBox.left()*d,f=f.top()+a.extensionBox.top()*d,h=a.pointTopLeft.x(),k=a.pointTopLeft.y(),l={},m=0;m<=a.yPoints;m++)for(var q=0;q<=a.xPoints;q++){var n=g+q*d,r=f+m*d,p=glift.util.point(h+q,k+m),n=glift.util.point(n,r);l[p.hash()]={intPt:p,coordPt:n,bbox:glift.displays.bboxFromPts(glift.util.point(n.x()-e,n.y()-e),glift.util.point(n.x()+
e,n.y()+e))}}return glift.displays.boardPoints(l,d,b)};var a=function(a,b,d){this.points=a;this.spacing=b;this.radius=b/2;this.numIntersections=d};a.prototype={getCoords:function(){return this.points},getCoord:function(a){return this.points[a.hash()]},forEach:function(a){for(var b in this.points)a(this.points[b])},data:function(){var a=[];this.forEach(function(b){a.push(b)});return a},hasCoord:function(a){return void 0!==this.points[a.hash()]},starPoints:function(){for(var a=glift.util.point,b={9:[[2,
6],[4]],13:[[3,9],[6]],19:[[3,9,15]]}[this.numIntersections]||[],d=[],e=0;e<b.length;e++)for(var f=b[e],g=0;g<f.length;g++)for(var h=0;h<f.length;h++){var k=a(f[g],f[h]);this.hasCoord(k)&&d.push(k)}return d},_debugDraw:function(a,b){for(var d in this.points){var e=this.points[d].bbox.center().x(),f=this.points[d].bbox.center().y();a.circle(e,f,this.radius).attr({fill:b,opacity:0.3})}}}})();
(function(){glift.displays.cropbox={LINE_EXTENSION:0.5,DEFAULT_EXTENSION:0,OVERFLOW:1.5,create:function(c,b,d,e){return new a(c,b,d,e)},getFromRegion:function(a,b){var d=glift.util,e=glift.enums.boardRegions;a=a||e.ALL;var f=b-1,g=Math.ceil(f/2),h=0,k=0,l=f,m=f,q=this.DEFAULT_EXTENSION,n=this.DEFAULT_EXTENSION,r=this.DEFAULT_EXTENSION,p=this.DEFAULT_EXTENSION;switch(a){case e.LEFT:m=g+1;p=this.LINE_EXTENSION;break;case e.RIGHT:k=g-1;n=this.LINE_EXTENSION;break;case e.TOP:l=g+1;r=this.LINE_EXTENSION;
break;case e.BOTTOM:h=g-1;q=this.LINE_EXTENSION;break;case e.TOP_LEFT:l=g+1;r=this.LINE_EXTENSION;m=g+2;p=this.LINE_EXTENSION;break;case e.TOP_RIGHT:l=g+1;r=this.LINE_EXTENSION;k=g-2;n=this.LINE_EXTENSION;break;case e.BOTTOM_LEFT:h=g-1;q=this.LINE_EXTENSION;m=g+2;p=this.LINE_EXTENSION;break;case e.BOTTOM_RIGHT:h=g-1,q=this.LINE_EXTENSION,k=g-2,n=this.LINE_EXTENSION}e=glift.displays.bboxFromPts(d.point(k,h),d.point(m,l));d=glift.displays.bboxFromPts(d.point(n,q),d.point(p,r));return glift.displays.cropbox.create(e,
d,0,f)}};var a=function(a,b,d,e){this._cbox=a;this._extBox=b};a.prototype={cbox:function(){return this._cbox},extBox:function(){return this._extBox},xPoints:function(){return this.cbox().width()},yPoints:function(){return this.cbox().height()},widthMod:function(){var a=glift.displays.cropbox.OVERFLOW;return this.cbox().width()+this.extBox().topLeft().x()+this.extBox().botRight().x()+a},heightMod:function(){var a=glift.displays.cropbox.OVERFLOW;return this.cbox().height()+this.extBox().topLeft().y()+
this.extBox().botRight().y()+a}}})();
(function(){glift.displays.environment={TOPBAR_SIZE:0.1,BOTTOMBAR_SIZE:0.1,get:function(c){return new a(c)},getInitialized:function(c){return(new a(c)).init()}};var a=function(a){this.divId=a.divId||"glift_display";this.boardRegion=a.boardRegion||glift.enums.boardRegions.ALL;this.intersections=a.intersections||19;a=a.displayConfig||{};this.cropbox=void 0!==a.cropbox?a.cropbox:glift.displays.cropbox.getFromRegion(this.boardRegion,this.intersections);this.widthOverride=this.heightOverride=!1;void 0!==
a.divHeight&&(this.divHeight=a.divHeight,this.heightOverride=!0);void 0!==a.divWidth&&(this.divWidth=a.divWidth,this.widthOverride=!0)};a.prototype={init:function(){(!this.heightOverride||!this.widthOverride)&&this._resetDimensions();var a=this.divHeight,b=this.divWidth,d=this.cropbox,a=glift.displays.bboxFromPts(glift.util.point(0,0),glift.util.point(b,a)),b=glift.displays.getResizedBox(a,d),d=glift.displays.getLineBox(b,d),e=glift.displays.boardPointsFromLineBox(d,this.intersections);this.divBox=
a;this.goBoardBox=b;this.goBoardLineBox=d;this.boardPoints=e;return this},_resetDimensions:function(){var a=glift.displays.bboxFromDiv(this.divId);this.divHeight=a.height();this.divWidth=a.width();return this},_debugDrawAll:function(){var a=Raphael(this.divId,"100%","100%");this.divBox.draw(a,"yellow");this.resizedBox.draw(a,"red");this.goBoardBox.draw(a,"orange");this.goBoardLineBox.bbox.draw(a,"red");this.goBoardLineBox._debugDrawLines(a,"blue");this.boardPoints._debugDraw(a,"green");this.lineSegments._debugDraw(a,
"black")}}})();
(function(){glift.displays.getLineBox=function(c,b){var d=glift.displays.cropbox.OVERFLOW/2,e=c.width()/b.widthMod(),f=c.height()/b.heightMod(),g=f*d,h=e*d,k=f*(b.heightMod()-d),d=e*(b.widthMod()-d),l=c.topLeft().x(),m=c.topLeft().y(),g=glift.displays.bboxFromPts(glift.util.point(h+l,g+m),glift.util.point(d+l,k+m));return new a(g,e,f,b)};var a=function(a,b,d,e){this.bbox=a;this._xSpacing=b;this._ySpacing=d;this.spacing=b;this.extensionBox=e.extBox();this.pointTopLeft=e.cbox().topLeft();this.xPoints=
e.xPoints();this.yPoints=e.yPoints()}})();glift.displays.getResizedBox=function(a,c){var b=glift.util,d=glift.displays.getCropDimensions(a.width(),a.height(),c),e=d.width(),f=d.height(),g=a.width()-e,h=a.height()-f,k=0===g?0:g/2,l=0===h?0:h/2,m=a.topLeft().x()+k,q=a.topLeft().y()+l,b=glift.displays.bbox(b.point(m,q),e,f);glift.global.debugMode&&(b._debugInfo=function(){return{newDims:d,newWidth:e,newHeight:f,xDiff:g,yDiff:h,xDelta:k,yDelta:l,newLeft:m,newTop:q}});return b};
glift.displays.getCropDimensions=function(a,c,b){var d=c/a;b=b.heightMod()/b.widthMod();var e=c,f=a;d>b?e=a*b:d<b&&(f=c/b);return{height:function(){return e},width:function(){return f}}};glift.displays.board={create:function(a,c,b){return(new glift.displays.board.Display(a,c,b)).draw()}};glift.displays.board.Display=function(a,c,b){this._objectHistory=[];this._environment=a;this._themeName=c;this._theme=b;this._intersections=this._svg=void 0};
glift.displays.board.Display.prototype={intersections:function(){return this._intersections},intersectionPoints:function(){return this._environment.intersections},boardPoints:function(){return this._environment.boardPoints},divId:function(){return this._environment.divId},theme:function(){return this._themeName},boardRegion:function(){return this._environment.boardRegion},width:function(){return this._environment.goBoardBox.width()},height:function(){return this._environment.goBoardBox.height()},
init:function(){void 0===this._svg&&(this.destroy(),this._svg=d3.select("#"+this.divId()).append("svg").attr("width","100%").attr("height","100%"));this._environment.init();return this},draw:function(){this.init();var a=glift.displays.board,c=this._environment,b=c.boardPoints,d=this._theme,e=this._svg,f=this.divId();a.initBlurFilter(f,e);a.boardBase(f,e,c.goBoardBox,d);var c=a.lines(f,e,b,d),g=a.starPoints(f,e,b,d),h=a.shadows(f,e,b,d),k=a.stones(f,e,b,d),l=a.markContainer(f,e,b,d),a=a.buttons(f,
e,b);this._intersections=new glift.displays.board._Intersections(f,e,{lineIds:c,starPointIds:g,stoneShadowIds:h,stoneIds:k,markIds:l,buttons:a},b,d);return this},destroy:function(){this.divId()&&d3.select("#"+this.divId()).selectAll("svg").remove();this._intersections=this._svg=void 0;return this},recreate:function(a){this.destroy();a=glift.displays.processOptions(a);this._environment=glift.displays.environment.get(a);this._themeName=a.theme;this._theme=glift.themes.get(a.theme);return this}};
glift.displays.board.boardBase=function(a,c,b,d){var e=glift.enums.svgElements.BOARD;a=glift.displays.gui.elementId(a,e);d.board.imagefill&&c.selectAll("goBoardRect").data([e]).enter().append("svg:image").attr("x",b.topLeft().x()).attr("y",b.topLeft().y()).attr("width",b.width()).attr("height",b.height()).attr("xlink:href",d.board.imagefill).attr("preserveAspectRatio","none").attr("id",a);c.selectAll("goBoardRect").data([e]).enter().append("rect").attr("x",b.topLeft().x()+"px").attr("y",b.topLeft().y()+
"px").attr("width",b.width()+"px").attr("height",b.height()+"px").attr("height",b.height()+"px").attr("fill",d.board.imagefill?"none":d.board.fill).attr("stroke",d.board.stroke).attr("stroke-width",d.board["stroke-width"]).attr("id",a);return a};
glift.displays.board.buttons=function(a,c,b){var d={},e=glift.enums.svgElements.BUTTON;c.selectAll(e).data(b.data()).enter().append("svg:rect").attr("x",function(a){return a.coordPt.x()-b.radius}).attr("y",function(a){return a.coordPt.y()-b.radius}).attr("width",b.spacing).attr("height",b.spacing).attr("class",e).attr("opacity",0).attr("fill","red").attr("stroke","red").attr("stone_color","EMPTY").attr("id",function(b){var c=glift.displays.gui.elementId(a,e,b.intPt);return d[b.intPt.hash()]=c});return d};
glift.displays.board._Intersections=function(a,c,b,d,e){this.divId=a;this.svg=c;this.theme=e;this.boardPoints=d;this.lineIds=b.lineIds;this.starPointIds=b.starPointIds;this.stoneShadowIds=b.stoneShadowIds;this.stoneIds=b.stoneIds;this.markIds=b.markIds;this.buttons=b.buttons;this.buttonsData=[];for(var f in this.buttons)this.buttonsData.push(glift.util.pointFromString(f))};
glift.displays.board._Intersections.prototype={setStoneColor:function(a,c){var b=a.hash();if(void 0===this.theme.stones[c])throw"Unknown color key ["+c+"]";if(void 0!==this.stoneIds[b]){var d=this.theme.stones[c];this.svg.select("#"+this.stoneIds[b]).attr("fill",d.fill).attr("stroke",d.stroke).attr("stone_color",c).attr("opacity",d.opacity);void 0!==this.stoneShadowIds[b]&&(1===d.opacity?this.svg.select("#"+this.stoneShadowIds[b]).attr("opacity",1):this.svg.select("#"+this.stoneShadowIds[b]).attr("opacity",
0))}return this},addMarkPt:function(a,c,b){glift.displays.board.addMark(this.divId,this.svg,this.boardPoints,this.theme,a,c,b);return this},clearMarks:function(){var a=glift.enums.svgElements;this.svg.selectAll("."+a.STARPOINT).attr("opacity",1);this.svg.selectAll("."+a.BOARD_LINE).attr("opacity",1);this.svg.selectAll("."+a.MARK).remove();return this},clearStones:function(){var a=glift.enums.svgElements;this.svg.selectAll("."+a.STONE).attr("opacity",0).attr("stone_color","EMPTY");this.svg.selectAll("."+
a.STONE_SHADOW).attr("opacity",0)},clearAll:function(){this.clearMarks();this.clearStones()},setEvent:function(a,c){this.svg.selectAll("rect."+glift.enums.svgElements.BUTTON).data(this.buttonsData).on(a,function(a){c(a)})}};
glift.displays.board.lines=function(a,c,b,d){var e={},f=glift.enums.svgElements.BOARD_LINE;c.selectAll(f).data(b.data()).enter().append("path").attr("d",function(a){return glift.displays.board.intersectionLine(a,b.radius,b.numIntersections,d)}).attr("stroke",d.lines.stroke).attr("stroke-width",d.lines["stroke-width"]).attr("class",f).attr("stroke-linecap","round").attr("id",function(b){var d=glift.displays.gui.elementId(a,f,b.intPt);return e[b.intPt.hash()]=d});return e};
glift.displays.board.intersectionLine=function(a,c,b){var d=b-1;b=a.coordPt;var e=a.intPt;a=glift.displays.board.svgutil;var f=0===e.y()?b.y():b.y()-c,g=e.y()===d?b.y():b.y()+c,h=0===e.x()?b.x():b.x()-c;c=e.x()===d?b.x():b.x()+c;return a.svgMove(b.x(),f)+" "+a.svgLineAbs(b.x(),g)+" "+a.svgMove(h,b.y())+" "+a.svgLineAbs(c,b.y())};glift.displays.board.markContainer=function(a,c,b,d){a=glift.enums.svgElements.MARK_CONTAINER;c.selectAll(a).data([1]).enter().append("g").attr("class",a);return{}};
glift.displays.board.addMark=function(a,c,b,d,e,f,g){var h=glift.displays.board.svgutil,k=glift.enums.svgElements,l=k.MARK,m=k.STONE,q=k.STARPOINT,n=k.BOARD_LINE,k=k.MARK_CONTAINER,r=glift.enums.marks,p=b.getCoord(e).coordPt,s=c.select("#"+glift.displays.gui.elementId(a,m,e)).attr("stone_color"),m=d.stones[s].marks;if("EMPTY"===s&&(f===r.LABEL||f===r.VARIATION_MARKER||f===r.CORRECT_VARIATION))c.select("#"+glift.displays.gui.elementId(a,q,e)).attr("opacity",0),c.select("#"+glift.displays.gui.elementId(a,
n,e)).attr("opacity",0);a=b.radius/8;f===r.LABEL||f==r.VARIATION_MARKER||f==r.CORRECT_VARIATION?(f===r.VARIATION_MARKER?m=m.VARIATION_MARKER:f===r.CORRECT_VARIATION&&(m=m.CORRECT_VARIATION),c.select("."+k).append("text").text(g).attr("fill",m.fill).attr("stroke",m.stroke).attr("class",l).attr("text-anchor","middle").attr("dy",".35em").attr("x",p.x()).attr("y",p.y()).attr("font-family",d.stones.marks["font-family"]).attr("font-size",0.7*b.spacing)):f===r.SQUARE?(b=b.radius/1.41421356237,h=b-a,c.select("."+
k).append("rect").attr("x",p.x()-h).attr("y",p.y()-h).attr("width",2*h).attr("height",2*h).attr("fill","none").attr("stroke-width",2).attr("class",l).attr("stroke",m.stroke)):f===r.XMARK?(b=b.radius/1.41421356237,g=b-a,b=p.translate(-1*g,-1*g),d=p.translate(g,-1*g),f=p.translate(-1*g,g),g=p.translate(g,g),c.select("."+k).append("path").attr("d",h.svgMovePt(p)+" "+h.svgLineAbsPt(b)+" "+h.svgMovePt(p)+" "+h.svgLineAbsPt(d)+" "+h.svgMovePt(p)+" "+h.svgLineAbsPt(f)+" "+h.svgMovePt(p)+" "+h.svgLineAbsPt(g)).attr("stroke-width",
2).attr("class",l).attr("stroke",m.stroke)):f===r.CIRCLE?c.select("."+k).append("circle").attr("cx",p.x()).attr("cy",p.y()).attr("r",b.radius/2).attr("fill","none").attr("stroke-width",2).attr("class",l).attr("stroke",m.stroke):f===r.STONE_MARKER?c.select("."+k).append("circle").attr("cx",p.x()).attr("cy",p.y()).attr("r",b.radius/3).attr("class",l).attr("opacity",m.STONE_MARKER.opacity).attr("fill",m.STONE_MARKER.fill):f===r.TRIANGLE&&(f=b.radius-b.radius/5,b=p.translate(0.866025403785*f,0.5*f),d=
p.translate(-0.866025403785*f,0.5*f),p=p.translate(0,-1*f),c.select("."+k).append("path").attr("fill","none").attr("d",h.svgMovePt(p)+" "+h.svgLineAbsPt(d)+" "+h.svgLineAbsPt(b)+" "+h.svgLineAbsPt(p)).attr("stroke-width",2).attr("class",l).attr("stroke",m.stroke));return this};
glift.displays.board.starPoints=function(a,c,b,d){var e=d.starPoints.sizeFraction*b.spacing,f=b.starPoints(),g=glift.enums.svgElements.STARPOINT,h={};c.selectAll(g).data(f).enter().append("circle").attr("cx",function(a){return b.getCoord(a).coordPt.x()}).attr("cy",function(a){return b.getCoord(a).coordPt.y()}).attr("r",e).attr("class",g).attr("fill",d.starPoints.fill).attr("id",function(b){var d=glift.displays.gui.elementId(a,g,b);return h[b.hash()]=d});return h};
glift.displays.board.stones=function(a,c,b,d){var e=glift.enums.svgElements.STONE,f={};c.selectAll(e).data(b.data()).enter().append("circle").attr("cx",function(a){return a.coordPt.x()}).attr("cy",function(a){return a.coordPt.y()}).attr("r",b.radius-0.2).attr("opacity",0).attr("class",glift.enums.svgElements.STONE).attr("stone_color","EMPTY").attr("fill","blue").attr("id",function(b){b=b.intPt;var d=glift.displays.gui.elementId(a,e,b);return f[b.hash()]=d});return f};
glift.displays.board.shadows=function(a,c,b,d){if(void 0===d.stones.shadows)return{};var e=glift.enums.svgElements.STONE_SHADOW,f={};c.selectAll(e).data(b.data()).enter().append("circle").attr("cx",function(a){return a.coordPt.x()+b.radius/7}).attr("cy",function(a){return a.coordPt.y()+b.radius/7}).attr("r",b.radius-0.4).attr("opacity",0).attr("class",e).attr("fill",d.stones.shadows.fill).attr("stroke",d.stones.shadows.stroke).attr("id",function(b){b=b.intPt;var d=glift.displays.gui.elementId(a,e,
b);return f[b.hash()]=d});return f};glift.displays.board.initBlurFilter=function(a,c){c.append("svg:defs").append("svg:filter").attr("id",a+"_svg_blur").append("svg:feGaussianBlur").attr("stdDeviation",2)};
glift.displays.board.svgutil={svgMove:function(a,c){return"M"+a+" "+c},svgMovePt:function(a){return glift.displays.board.svgutil.svgMove(a.x(),a.y())},svgLineRel:function(a,c){return"l"+a+" "+c},svgLineRelPt:function(a){return glift.displays.board.svgutil.svgLineRel(a.x(),a.y())},svgLineAbs:function(a,c){return"L"+a+" "+c},svgLineAbsPt:function(a){return glift.displays.board.svgutil.svgLineAbs(a.x(),a.y())}};
glift.displays.gui={elementId:function(a,c,b){a=a+"_"+c;return void 0!==b?void 0!==b.x?a+"_"+b.x()+"_"+b.y():a+"_"+b.toString():a}};
glift.displays.gui.rowCenter=function(a,c,b,d,e,f){var g=a.width()-2*d,h=a.height()-2*b,k=[],l=[],m=0;0>=f&&(f=1E7);for(var q=0;q<c.length;q++){var n=c[q],r=h>g?g/n.width():h/n.height(),p={scale:r},n=n.scale(r);k.push(p);l.push(n);m+=n.width()+e}m-=e;for(q=[];g<m;)p=l.pop(),n=k.pop(),m-=p.width()+e,q.push(n);q=g-m;n=e=p=q/(k.length+1);p>f&&(e=f,n=(q-e*(k.length-1))/2);d=a.left()+d+n;a=a.top()+b;b=[];for(q=0;q<l.length;q++)n=l[q],p=k[q],f=a-n.top(),g=d-n.left(),p.xMove=g,p.yMove=f,b.push(n.translate(g,
f)),d+=n.width()+e;return{transforms:k,bboxes:b}};glift.displays.gui.centerWithin=function(a,c,b,d){var e=a.width()-2*d,f=a.height()-2*b,g=1,g=f/e>c.height()/c.width()?e/c.width():f/c.width();c=c.scale(g);d=a.left()+d;c.width()<e&&(d+=(e-c.width())/2);a=a.top()+b;c.height()<f&&(a+=(f-c.height())/2);f={xMove:d-c.left(),yMove:a-c.top(),scale:g};c=c.translate(f.xMove,f.yMove);return{transform:f,bbox:c}};
(function(){glift.displays.gui.commentBox=function(c,b,d,e,f){return(new a(c,b,d,e,f)).draw()};var a=function(a,b,d,e,f){this.divId=a;this.displayWidth=b;this.boundingWidth=d;this.themeName=e;this.theme=glift.themes.get(e);this.useBoardImage=f;this.commentBoxObj=void 0};a.prototype={draw:function(){this.commentBoxObj=$("#"+this.divId);var a=$("#"+this.divId).height(),b=this.theme.board["stroke-width"],d=this.displayWidth;this.commentBoxObj.css({background:"#CCCCFF",border:"1px solid",left:(this.boundingWidth-
this.displayWidth)/2-b,width:this.displayWidth+b,height:a,margin:"auto","font-family":"Baskerville",overflow:"auto","font-size":15>d/25?15:d/25,"-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box",padding:10});return this},setText:function(a){this.commentBoxObj.html("<p>"+a.replace(/\n/g,"<br><p>"))},clearText:function(){this.commentBoxObj.html("")},destroy:function(){this.commentBoxObj.empty()}}})();
(function(){glift.displays.gui.iconBar=function(c){var b=c.divId,d=c.icons||[],e=c.vertMargin||0,f=c.horzMargin||0;c=c.theme||"DEFAULT";if(void 0===b)throw"Must define an options 'divId' as an option";for(var g=0;g<d.length;g++)if(void 0===glift.displays.gui.icons[d[g]])throw"Icon string undefined in glift.displays.gui.icons ["+d[g]+"]";return(new a(b,c,d,e,f)).draw()};var a=function(a,b,d,e,f){this.divId=a;this.themeName=b;this.theme=glift.themes.get(b);this.iconNames=d;this.vertMargin=e;this.horzMargin=
f;this.events={};this.newIconBboxes={};this.svg=void 0;this.tempIconIds=[]};a.prototype={draw:function(){this.destroy();var a=glift.displays.bboxFromDiv(this.divId),b=d3.select("#"+this.divId).append("svg").attr("width","100%").attr("height","100%"),d=glift.displays.gui,e=[],f=[],g=[],h=glift.util.point;this.svg=b;for(var k=0;k<this.iconNames.length;k++){var l=d.icons[this.iconNames[k]];f.push(l.string);e.push(glift.displays.bboxFromPts(h(l.bbox.x,l.bbox.y),h(l.bbox.x2,l.bbox.y2)));g.push(k)}for(var m=
glift.displays.gui.rowCenter(a,e,this.vertMargin,this.horzMargin,0,0),k=0;k<m.bboxes.length;k++)this.newIconBboxes[this.iconNames[k]]=m.bboxes[k];var q=this;b.selectAll("icons").data(g).enter().append("path").attr("d",function(a){return f[a]}).attr("fill",this.theme.icons.DEFAULT.fill).attr("id",function(a){return q.iconId(q.iconNames[a])}).attr("transform",function(a){return glift.displays.gui.scaleAndMoveString(m.bboxes[a],m.transforms[a])});var n=m.bboxes;b.selectAll("buttons").data(g).enter().append("rect").attr("x",
function(a){return n[a].topLeft().x()}).attr("y",function(a){return n[a].topLeft().y()}).attr("width",function(a){return n[a].width()}).attr("height",function(a){return n[a].height()}).attr("fill","blue").attr("opacity",0).attr("_icon",function(a){return q.iconNames[a]}).attr("id",function(a){return q.buttonId(q.iconNames[a])});return this},addTempIcon:function(a,b,d){var e=glift.displays.gui.icons[a],f=glift.displays.bboxFromPts(glift.util.point(e.bbox.x,e.bbox.y),glift.util.point(e.bbox.x2,e.bbox.y2)),
g=this.iconId(a);b=glift.displays.gui.centerWithin(b,f,2,2);this.svg.append("path").attr("d",e.string).attr("fill",d).attr("id",this.iconId(a)).attr("transform",glift.displays.gui.scaleAndMoveString(b.bbox,b.transform));this.tempIconIds.push(g);return this},destroyTempIcons:function(){for(var a=0;a<this.tempIconIds.length;a++)this.svg.select("#"+this.tempIconIds[a]).remove();this.tempIconIds=[];return this},iconId:function(a){return glift.displays.gui.elementId(this.divId,glift.enums.svgElements.ICON,
a)},buttonId:function(a){return glift.displays.gui.elementId(this.divId,glift.enums.svgElements.BUTTON,a)},setEvent:function(a,b,d){var e=this;this.events[b]=d;d3.select("#"+e.buttonId(b)).on(a,function(){d(e.getIcon(b))});return this},forceEvent:function(a){if(void 0!==this.events[a])this.events[a]();return this},setHover:function(a,b,d){this.setEvent("mouseover",a,b);this.setEvent("mouseout",a,d)},getIcon:function(a){return{name:a,iconId:this.iconId(a),newBbox:this.newIconBboxes[a]}},forEachIcon:function(a){for(var b=
0;b<this.iconNames.length;b++)a(this.getIcon(this.iconNames[b]))},redraw:function(){this.destroy();this.draw()},destroy:function(){this.divId&&d3.select("#"+this.divId).selectAll("svg").remove();this.events={};return this}}})();
glift.displays.gui.icons={cross:{string:"M24.778,21.419 19.276,15.917 24.777,10.415 21.949,7.585 16.447,13.087 10.945,7.585 8.117,10.415 13.618,15.917 8.116,21.419 10.946,24.248 16.447,18.746 21.948,24.248z",bbox:{x:8.116,y:7.585,x2:24.778,y2:24.248,width:16.662,height:16.663}},check:{string:"M2.379,14.729 5.208,11.899 12.958,19.648 25.877,6.733 28.707,9.561 12.958,25.308z",bbox:{x:2.379,y:6.733,x2:28.707,y2:25.308,width:26.328,height:18.575}},refresh:{string:"M24.083,15.5c-0.009,4.739-3.844,8.574-8.583,8.583c-4.741-0.009-8.577-3.844-8.585-8.583c0.008-4.741,3.844-8.577,8.585-8.585c1.913,0,3.665,0.629,5.09,1.686l-1.782,1.783l8.429,2.256l-2.26-8.427l-1.89,1.89c-2.072-1.677-4.717-2.688-7.587-2.688C8.826,3.418,3.418,8.826,3.416,15.5C3.418,22.175,8.826,27.583,15.5,27.583S27.583,22.175,27.583,15.5H24.083z",
bbox:{x:3.416,y:3.415,x2:27.583,y2:27.583,width:24.167,height:24.168}},undo:{string:"M12.981,9.073V6.817l-12.106,6.99l12.106,6.99v-2.422c3.285-0.002,9.052,0.28,9.052,2.269c0,2.78-6.023,4.263-6.023,4.263v2.132c0,0,13.53,0.463,13.53-9.823C29.54,9.134,17.952,8.831,12.981,9.073z",bbox:{x:0.875,y:6.817,x2:29.54,y2:27.042158,width:28.665,height:20.225158}},"chevron-right":{string:"M10.129,22.186 16.316,15.999 10.129,9.812 13.665,6.276 23.389,15.999 13.665,25.725z",bbox:{x:10.129,y:6.276,x2:23.389,y2:25.725,
width:13.26,height:19.449}},"chevron-left":{string:"M21.871,9.814 15.684,16.001 21.871,22.188 18.335,25.725 8.612,16.001 18.335,6.276z",bbox:{x:8.612,y:6.276,x2:21.871,y2:25.725,width:13.259,height:19.449}},"small-gear":{string:"M31.229,17.736c0.064-0.571,0.104-1.148,0.104-1.736s-0.04-1.166-0.104-1.737l-4.377-1.557c-0.218-0.716-0.504-1.401-0.851-2.05l1.993-4.192c-0.725-0.91-1.549-1.734-2.458-2.459l-4.193,1.994c-0.647-0.347-1.334-0.632-2.049-0.849l-1.558-4.378C17.165,0.708,16.588,0.667,16,0.667s-1.166,0.041-1.737,0.105L12.707,5.15c-0.716,0.217-1.401,0.502-2.05,0.849L6.464,4.005C5.554,4.73,4.73,5.554,4.005,6.464l1.994,4.192c-0.347,0.648-0.632,1.334-0.849,2.05l-4.378,1.557C0.708,14.834,0.667,15.412,0.667,16s0.041,1.165,0.105,1.736l4.378,1.558c0.217,0.715,0.502,1.401,0.849,2.049l-1.994,4.193c0.725,0.909,1.549,1.733,2.459,2.458l4.192-1.993c0.648,0.347,1.334,0.633,2.05,0.851l1.557,4.377c0.571,0.064,1.148,0.104,1.737,0.104c0.588,0,1.165-0.04,1.736-0.104l1.558-4.377c0.715-0.218,1.399-0.504,2.049-0.851l4.193,1.993c0.909-0.725,1.733-1.549,2.458-2.458l-1.993-4.193c0.347-0.647,0.633-1.334,0.851-2.049L31.229,17.736zM16,20.871c-2.69,0-4.872-2.182-4.872-4.871c0-2.69,2.182-4.872,4.872-4.872c2.689,0,4.871,2.182,4.871,4.872C20.871,18.689,18.689,20.871,16,20.871z",
bbox:{x:0.667,y:0.667,x2:31.333,y2:31.333,width:30.666,height:30.666}},"question-bubble":{string:"M16,4.938c-7.732,0-14,4.701-14,10.5c0,1.981,0.741,3.833,2.016,5.414L2,25.272l5.613-1.44c2.339,1.316,5.237,2.106,8.387,2.106c7.732,0,14-4.701,14-10.5S23.732,4.938,16,4.938zM16.982,21.375h-1.969v-1.889h1.969V21.375zM16.982,17.469v0.625h-1.969v-0.769c0-2.321,2.641-2.689,2.641-4.337c0-0.752-0.672-1.329-1.553-1.329c-0.912,0-1.713,0.672-1.713,0.672l-1.12-1.393c0,0,1.104-1.153,3.009-1.153c1.81,0,3.49,1.121,3.49,3.009C19.768,15.437,16.982,15.741,16.982,17.469z",
bbox:{x:2,y:4.938,x2:30,y2:25.938,width:28,height:21}},roadmap:{string:"M23.188,3.735c0-0.975-0.789-1.766-1.766-1.766s-1.766,0.791-1.766,1.766s1.766,4.267,1.766,4.267S23.188,4.71,23.188,3.735zM20.578,3.734c0-0.466,0.378-0.843,0.844-0.843c0.467,0,0.844,0.377,0.844,0.844c0,0.466-0.377,0.843-0.844,0.843C20.956,4.578,20.578,4.201,20.578,3.734zM25.281,18.496c-0.562,0-1.098,0.046-1.592,0.122L11.1,13.976c0.199-0.181,0.312-0.38,0.312-0.59c0-0.108-0.033-0.213-0.088-0.315l8.41-2.239c0.459,0.137,1.023,0.221,1.646,0.221c1.521,0,2.75-0.485,2.75-1.083c0-0.599-1.229-1.083-2.75-1.083s-2.75,0.485-2.75,1.083c0,0.069,0.021,0.137,0.054,0.202L9.896,12.2c-0.633-0.188-1.411-0.303-2.265-0.303c-2.088,0-3.781,0.667-3.781,1.49c0,0.823,1.693,1.489,3.781,1.489c0.573,0,1.11-0.054,1.597-0.144l11.99,4.866c-0.19,0.192-0.306,0.401-0.306,0.623c0,0.188,0.096,0.363,0.236,0.532L8.695,25.415c-0.158-0.005-0.316-0.011-0.477-0.011c-3.241,0-5.87,1.037-5.87,2.312c0,1.276,2.629,2.312,5.87,2.312c3.241,0,5.87-1.034,5.87-2.312c0-0.22-0.083-0.432-0.229-0.633l10.265-5.214c0.37,0.04,0.753,0.066,1.155,0.066c2.414,0,4.371-0.771,4.371-1.723C29.65,19.268,27.693,18.496,25.281,18.496z",
bbox:{x:2.348,y:1.969,x2:29.65,y2:30.028,width:27.302,height:28.059}},play:{string:"M6.684,25.682L24.316,15.5L6.684,5.318V25.682z",bbox:{x:6.684,y:5.318,x2:24.316,y2:25.682,width:17.632,height:20.364}},end:{string:"M21.167,5.5,21.167,13.681,6.684,5.318,6.684,25.682,21.167,17.318,21.167,25.5,25.5,25.5,25.5,5.5z",bbox:{x:6.684,y:5.318,x2:25.5,y2:25.682,width:18.816,height:20.364}},start:{string:"M24.316,5.318,9.833,13.682,9.833,5.5,5.5,5.5,5.5,25.5,9.833,25.5,9.833,17.318,24.316,25.682z",bbox:{x:5.5,
y:5.318,x2:24.316,y2:25.682,width:18.816,height:20.364}},arrowup:{string:"M23.963,20.834L17.5,9.64c-0.825-1.429-2.175-1.429-3,0L8.037,20.834c-0.825,1.429-0.15,2.598,1.5,2.598h12.926C24.113,23.432,24.788,22.263,23.963,20.834z",bbox:{x:7.684895,y:8.56825,x2:24.315105,y2:23.432,width:16.630209,height:14.86375}},arrowright:{string:"M11.166,23.963L22.359,17.5c1.43-0.824,1.43-2.175,0-3L11.166,8.037c-1.429-0.826-2.598-0.15-2.598,1.5v12.926C8.568,24.113,9.737,24.789,11.166,23.963z",bbox:{x:8.568,y:7.684457,
x2:23.4315,y2:24.315543,width:14.8635,height:16.631086}},arrowleft:{string:"M20.834,8.037L9.641,14.5c-1.43,0.824-1.43,2.175,0,3l11.193,6.463c1.429,0.826,2.598,0.15,2.598-1.5V9.537C23.432,7.887,22.263,7.211,20.834,8.037z",bbox:{x:8.5685,y:7.684457,x2:23.432,y2:24.315543,width:14.8635,height:16.631086}},detour:{string:"M29.342,15.5l-7.556-4.363v2.614H18.75c-1.441-0.004-2.423,1.002-2.875,1.784c-0.735,1.222-1.056,2.561-1.441,3.522c-0.135,0.361-0.278,0.655-0.376,0.817c-1.626,0-0.998,0-2.768,0c-0.213-0.398-0.571-1.557-0.923-2.692c-0.237-0.676-0.5-1.381-1.013-2.071C8.878,14.43,7.89,13.726,6.75,13.75H2.812v3.499c0,0,0.358,0,1.031,0h2.741c0.008,0.013,0.018,0.028,0.029,0.046c0.291,0.401,0.634,1.663,1.031,2.888c0.218,0.623,0.455,1.262,0.92,1.897c0.417,0.614,1.319,1.293,2.383,1.293H11c2.25,0,1.249,0,3.374,0c0.696,0.01,1.371-0.286,1.809-0.657c1.439-1.338,1.608-2.886,2.13-4.127c0.218-0.608,0.453-1.115,0.605-1.314c0.006-0.01,0.012-0.018,0.018-0.025h2.85v2.614L29.342,15.5zM10.173,14.539c0.568,0.76,0.874,1.559,1.137,2.311c0.04,0.128,0.082,0.264,0.125,0.399h2.58c0.246-0.697,0.553-1.479,1.005-2.228c0.252-0.438,0.621-0.887,1.08-1.272H9.43C9.735,14.003,9.99,14.277,10.173,14.539z",
bbox:{x:2.812,y:11.137,x2:29.342,y2:23.37325,width:26.53,height:12.23625}},checkbox:{string:"M26,27.5H6c-0.829,0-1.5-0.672-1.5-1.5V6c0-0.829,0.671-1.5,1.5-1.5h20c0.828,0,1.5,0.671,1.5,1.5v20C27.5,26.828,26.828,27.5,26,27.5zM7.5,24.5h17v-17h-17V24.5z",bbox:{x:4.5,y:4.5,x2:27.5,y2:27.5,width:23,height:23}},edit:{string:"M27.87,7.863L23.024,4.82l-7.889,12.566l4.842,3.04L27.87,7.863zM14.395,21.25l-0.107,2.855l2.527-1.337l2.349-1.24l-4.672-2.936L14.395,21.25zM29.163,3.239l-2.532-1.591c-0.638-0.401-1.479-0.208-1.882,0.43l-0.998,1.588l4.842,3.042l0.999-1.586C29.992,4.481,29.802,3.639,29.163,3.239zM25.198,27.062c0,0.275-0.225,0.5-0.5,0.5h-19c-0.276,0-0.5-0.225-0.5-0.5v-19c0-0.276,0.224-0.5,0.5-0.5h13.244l1.884-3H5.698c-1.93,0-3.5,1.57-3.5,3.5v19c0,1.93,1.57,3.5,3.5,3.5h19c1.93,0,3.5-1.57,3.5-3.5V11.097l-3,4.776V27.062z",
bbox:{x:2.198,y:1.4388,x2:29.80125,y2:30.562,width:27.60325,height:29.12316}},twostones:{string:"m 42.894737,29.335869 c 0,6.540213 -5.301891,11.842106 -11.842105,11.842106 -6.540214,0 -11.842105,-5.301893 -11.842105,-11.842106 0,-6.540214 5.301891,-11.842105 11.842105,-11.842105 6.540214,0 11.842105,5.301891 11.842105,11.842105 z M 31.052632,16.309553 c -7.194236,0 -13.026316,5.83208 -13.026316,13.026316 0,7.194233 5.83208,13.026314 13.026316,13.026314 3.733917,0 7.098575,-1.575815 9.473684,-4.092928 2.375029,2.516206 5.740532,4.092928 9.473684,4.092928 7.194235,0 13.026316,-5.832081 13.026316,-13.026314 0,-7.194236 -5.832081,-13.026316 -13.026316,-13.026316 -3.733152,0 -7.098655,1.56932 -9.473684,4.085526 -2.374906,-2.51483 -5.741698,-4.085526 -9.473684,-4.085526 z",
bbox:{x:18.026316,y:16.309553,x2:63.026316,y2:42.362183,width:45,height:26.05263}}};glift.displays.gui.scaleAndMoveString=function(a,c){return"translate("+c.xMove+","+c.yMove+") scale("+c.scale+")"};glift.displays.gui.DivSplit=function(a,c,b){this.id=a;this.start=c;this.length=b};
glift.displays.gui.splitDiv=function(a,c,b){var d=glift.displays.bboxFromDiv(a),e=0;b?"vertical"!==b&&"horizontal"!==b&&(b="horizontal"):b="horizontal";for(var f=0;f<c.length;f++)e+=c[f];if(1<e||0>e)throw"Percents must sum to a number be between 0 and 1.Was "+e;c.push(1-e);for(var e=[],g="horizontal"===b?d.top():d.left(),d="horizontal"===b?d.height():d.width(),f=0;f<c.length;f++)e.push(new glift.displays.gui.DivSplit("glift_internal_div_"+glift.util.idGenerator.next(),g,d*c[f])),g+=d*c[f];for(f=0;f<
e.length;f++)$("#"+a).append('<div id="'+e[f].id+'"></div>'),c={width:"horizontal"===b?"100%":e[f].length,height:"horizontal"===b?e[f].length:"100%",position:"absolute"},c["horizontal"===b?"top":"left"]=e[f].start,$("#"+e[f].id).css(c);return e};glift.displays.gui.repack=function(){};glift.rules={};
(function(){glift.rules.goban={getInstance:function(b){return new a(b||19)},getFromMoveTree:function(b,c){var f=new a(b.getIntersections()),g=b.getTreeFromRoot();c=c||[];var h=[];f.loadStonesFromMovetree(g);for(var k=0;k<c.length;k++)g.moveDown(c[k]),h.push(f.loadStonesFromMovetree(g));return{goban:f,captures:h}}};var a=function(a){if(0>=a)throw"Intersections must be greater than 0";this.ints=a;for(var b=[],c=0;c<a;c++){for(var g=[],h=0;h<a;h++)g[h]=glift.enums.states.EMPTY;b[c]=g}this.stones=b};
a.prototype={intersections:function(){return this.ints},getStone:function(a){return this.stones[a.y()][a.x()]},getAllPlacedStones:function(){for(var a=[],b=0;b<this.stones.length;b++)for(var c=this.stones[b],g=0;g<c.length;g++){var h=glift.util.point(g,b),k=this.getStone(h);(k===glift.enums.states.BLACK||k===glift.enums.states.WHITE)&&a.push({point:h,color:k})}return a},placeable:function(a,b){return this.inBounds(a)&&this.getStone(a)===glift.enums.states.EMPTY},outBounds:function(a){return glift.util.outBounds(a.x(),
this.ints)||glift.util.outBounds(a.y(),this.ints)},inBounds:function(a){return glift.util.inBounds(a.x(),this.ints)&&glift.util.inBounds(a.y(),this.ints)},clearStone:function(a){this._setColor(a,glift.enums.states.EMPTY)},clearSome:function(a){for(var b=0;b<a.length;b++)this.clearStone(a[b])},_setColor:function(a,b){this.stones[a.y()][a.x()]=b},addStone:function(a,e){if(!glift.util.colors.isLegalColor(e))throw"Unknown color: "+e;if(this.outBounds(a)||!this.placeable(a))return new b(!1);this._setColor(a,
e);var f=new c,g=glift.util.colors.oppositeColor(e);this._getCaptures(f,glift.util.point(a.x()+1,a.y()),g);this._getCaptures(f,glift.util.point(a.x()-1,a.y()),g);this._getCaptures(f,glift.util.point(a.x(),a.y()-1),g);this._getCaptures(f,glift.util.point(a.x(),a.y()+1),g);if(0>=f.numCaptures&&(this._getCaptures(f,a,e),0<f.numCaptures))return this.clearStone(a),new b(!1);f=f.getCaptures();this.clearSome(f);return new b(!0,f)},_getCaptures:function(a,b,c){this._findConnected(a,b,c);0>=a.liberties&&a.consideringToCaptures();
a.clearExceptCaptures()},_findConnected:function(a,b,c){var g=glift.util;if(!(void 0!==a.seen[b.hash()]||this.outBounds(b))){a.seen[b.hash()]=!0;var h=this.getStone(b);if(h===glift.enums.states.EMPTY)a.liberties++;else if(h!==g.colors.oppositeColor(c))if(h===c)a.considering.push(b),this._findConnected(a,g.point(b.x()+1,b.y()),c),this._findConnected(a,g.point(b.x()-1,b.y()),c),this._findConnected(a,g.point(b.x(),b.y()+1),c),this._findConnected(a,g.point(b.x(),b.y()-1),c);else throw"Unknown color error: "+
h;}},loadStonesFromMovetree:function(a){for(var b=[glift.enums.states.BLACK,glift.enums.states.WHITE],c={BLACK:[],WHITE:[]},g=0;g<b.length;g++)for(var h=b[g],k=a.properties().getPlacementsAsPoints(h),l=0;l<k.length;l++)this._loadStone({point:k[l],color:h},c);this._loadStone(a.properties().getMove(),c);return c},_loadStone:function(a,b){if(a!==glift.util.none&&void 0!==a.point){var c=this.addStone(a.point,a.color);if(c.successful)for(var g=glift.util.colors.oppositeColor(a.color),h=0;h<c.captures.length;h++)b[g].push(c.captures[h])}},
unloadStones:function(a,b){for(var c in a)for(var g=0;g<a[c].length;g++)this.clearStone(a[c][g]);for(c in b)for(g=0;g<b[c].length;g++)this.addStone(b[c][g],c)},_debug:function(){glift.util.logz(this.stones)}};var c=function(){this.toCapture={};this.numCaptures=0;this.considering=[];this.seen={};this.liberties=0};c.prototype={clearExceptCaptures:function(){this.considering=[];this.seen={};this.liberties=0},consideringToCaptures:function(){for(var a=0;a<this.considering.length;a++){var b=this.considering[a];
void 0===this.toCapture[b.hash()]&&(this.toCapture[b.hash()]=!0,this.numCaptures++)}},addLiberties:function(a){this.liberties+=a},addSeen:function(a){this.seen[a.hash()]=!0},getCaptures:function(){var a=[],b;for(b in this.toCapture)a.push(glift.util.pointFromHash(b));return a}};var b=function(a,b){this.captures=(this.successful=a)?b:[]}})();
(function(){glift.rules.intersections={propertiesToMarks:{CR:glift.enums.marks.CIRCLE,LB:glift.enums.marks.LABEL,MA:glift.enums.marks.XMARK,SQ:glift.enums.marks.SQUARE,TR:glift.enums.marks.TRIANGLE},basePropertyData:function(a,c){var b={stones:{WHITE:[],BLACK:[],EMPTY:[]},marks:{},comment:glift.util.none,lastMove:glift.util.none,nextMoves:[],correctNextMoves:[],captures:[],displayDataType:glift.enums.displayDataTypes.PARTIAL};b.comment=a.properties().getComment();b.lastMove=a.getLastMove();b.marks=
glift.rules.intersections.getCurrentMarks(a);b.nextMoves=a.nextMoves();b.correctNextMoves=void 0!==c?glift.rules.problems.correctNextMoves(a,c):[];return b},getFullBoardData:function(a,c,b){a=glift.rules.intersections.basePropertyData(a,b);a.displayDataType=glift.enums.displayDataTypes.FULL;c=c.getAllPlacedStones();for(b=0;b<c.length;b++){var d=c[b];a.stones[d.color].push(d.point)}return a},nextBoardData:function(a,c,b){b=glift.rules.intersections.basePropertyData(a,b);b.stones=a.properties().getAllStones();
b.stones.EMPTY=[];for(var d in c)for(a=0;a<c[d].length;a++)b.stones.EMPTY.push(c[d][a]);return b},previousBoardData:function(a,c,b,d){a=glift.rules.intersections.basePropertyData(a,d);a.stones=b;a.stones.EMPTY=[];for(var e in c)for(b=0;b<c[e].length;b++)a.stones.EMPTY.push(c[e][b]);return a},getCurrentMarks:function(a){var c={},b;for(b in glift.rules.intersections.propertiesToMarks){var d=glift.rules.intersections.propertiesToMarks[b];if(a.properties().contains(b)){for(var e=[],f=a.properties().getAllValues(b),
g=0;g<f.length;g++)b===glift.sgf.allProperties.LB?e.push(glift.sgf.convertFromLabelData(f[g])):e.push(glift.util.pointFromSgfCoord(f[g]));c[d]=e}}return c}}})();
(function(){glift.rules.movenode=function(b,c){return new a(b,c)};var a=function(a,c){this._properties=a||glift.rules.properties();this.children=c||[];this._nodeId={nodeNum:0,varNum:0}};a.prototype={properties:function(){return this._properties},_setNodeId:function(a,c){this._nodeId={nodeNum:a,varNum:c};return this},getNodeNum:function(){return this._nodeId.nodeNum},getVarNum:function(){return this._nodeId.varNum},numChildren:function(){return this.children.length},addChild:function(){this.children.push(glift.rules.movenode()._setNodeId(this.getNodeNum()+
1,this.numChildren()));return this},getChild:function(a){return void 0===a?this.children[0]:this.children[a]},renumber:function(){c(this,this._nodeId.nodeNum,this._nodeId.varNum);return this}};var c=function(a,d,e){a._setNodeId(d,e);for(e=0;e<a.children.length;e++)c(a.children[e],d+1,e);return a}})();
(function(){var a=glift.util,c=glift.enums;glift.rules.movetree={getInstance:function(a){return(new b(glift.rules.movenode())).setIntersections(a||19)},getFromSgf:function(a,b){b=b||[];if(void 0===a||""===a)return glift.rules.movetree.getInstance(19);for(var c=glift.sgf.parse(a),g=0;g<b.length;g++)c.moveDown(b[g]);return c},getFromNode:function(a){return new b(a)},searchMoveTreeDFS:function(a,b){b(a);for(var c=0;c<a.node().numChildren();c++)glift.rules.movetree.searchMoveTreeDFS(a.moveDown(c),b);
a.moveUp()}};var b=function(a){this._nodeHistory=[];this._nodeHistory.push(a)};b.prototype={getTreeFromRoot:function(){return glift.rules.movetree.getFromNode(this._nodeHistory[0])},node:function(){return this._nodeHistory[this._nodeHistory.length-1]},properties:function(){return this.node().properties()},findNextMove:function(b,c){for(var f=this.node().children,g=glift.sgf.colorToToken(c),h={},k=0;k<f.length;k++){var l=f[k];l.properties().contains(g)&&""!=l.properties().getOneValue(g)&&(h[l.properties().getAsPoint(g).hash()]=
l.getVarNum())}return void 0!==h[b.hash()]?h[b.hash()]:a.none},getLastMove:function(){return this.properties().getMove()},nextMoves:function(){for(var a=this.node(),b=[],c=0;c<a.numChildren();c++){var g=a.getChild(c).properties().getMove();g!==glift.util.none&&b.push(g)}return b},getCurrentPlayer:function(){var b=this.properties().getMove();return b===a.none?c.states.BLACK:b.color===c.states.BLACK?c.states.WHITE:c.states.BLACK},moveDown:function(a){a=void 0===a?0:a;void 0!==this.node().getChild(a)&&
(a=this.node().getChild(a),this._nodeHistory.push(a));return this},moveUp:function(){1<this._nodeHistory.length&&this._nodeHistory.pop();return this},moveToRoot:function(){this._nodeHistory=this._nodeHistory.slice(0,1);return this},addNode:function(){this.node().addChild();this.moveDown(this.node().numChildren()-1);return this},deleteCurrentNode:function(){throw"Unfinished";},recurse:function(a){glift.rules.movetree.searchMoveTreeDFS(this,a)},recurseFromRoot:function(a){glift.rules.movetree.searchMoveTreeDFS(this.getTreeFromRoot(),
a)},toSgf:function(){for(var a in this.getAllProps());},debugLog:function(a){void 0===a&&(a="  ");glift.util.logz(a+this.node(b).getVarNum()+"-"+this.node(b).getNodeNum());for(var b=0;b<this.node().numChildren();b++)this.moveDown(b),this.debugLog(a),this.moveUp()},setIntersections:function(a){var b=this.getTreeFromRoot(),c=glift.sgf.allProperties;b.properties().contains(c.SZ)||this.properties().add(c.SZ,a+"");return this},getIntersections:function(){var a=this.getTreeFromRoot(),b=glift.sgf.allProperties;
if(a.node().properties().contains(b.SZ))return parseInt(a.node().properties().getAllValues(b.SZ))}}})();
glift.rules.problems={isCorrectPosition:function(a,c){var b=glift.enums.problemResults;if(a.properties().matches(c))return b.CORRECT;for(var d=glift.rules.treepath.flattenMoveTree(a),e={},f=0;f<d.length;f++){for(var g=d[f],h=glift.rules.movetree.getFromNode(a.node()),k=!1,l=0;l<g.length;l++)h.moveDown(g[l]),h.properties().matches(c)&&(k=!0);k?e[b.CORRECT]=!0:e[b.INCORRECT]=!0}return e[b.CORRECT]&&!e[b.INCORRECT]?b.CORRECT:e[b.CORRECT]&&e[b.INCORRECT]?b.INDETERMINATE:b.INCORRECT},correctNextMoves:function(a,
c){for(var b=a.nextMoves(),d=glift.enums.problemResults.INCORRECT,e=[],f=0;f<b.length;f++)a.moveDown(f),glift.rules.problems.isCorrectPosition(a,c)!==d&&e.push(b[f]),a.moveUp();return e}};
(function(){var a=glift.util,c=glift.enums;glift.rules.properties=function(a){return new b(a)};var b=function(a){this.propMap=void 0===a?{}:a};b.prototype={add:function(b,c){if(void 0===glift.sgf.allProperties[b])throw"Can't add undefined properties";"string"!==a.typeOf(c)&&"array"!==a.typeOf(c)&&(c=c.toString());c="string"===a.typeOf(c)?[c]:c;this.contains(b)?this.propMap[b]=this.getAllValues(b).concat(c):this.propMap[b]=c;return this},getAllValues:function(b){return void 0===glift.sgf.allProperties[b]?
a.none:void 0!==this.propMap[b]?this.propMap[b]:a.none},getOneValue:function(b,c){c=void 0!==c&&"number"===typeof c&&0<=c?c:0;var f=this.getAllValues(b);return f!==a.none&&1<=f.length?f[c]:a.none},getAsPoint:function(b,c){var f=this.getOneValue(b,c);return f===a.none?f:glift.util.pointFromSgfCoord(f)},contains:function(b){return this.getAllValues(b)!==a.none},remove:function(b){if(this.contains(b)){var c=this.getAllValues(b);delete this.propMap[b];return c}return a.none},replace:function(a,b){this.propMap[a]=
b},getPlacementsAsPoints:function(a){var b="";a===c.states.BLACK?b=glift.sgf.allProperties.AB:a===c.states.WHITE&&(b=glift.sgf.allProperties.AW);return""===b||!this.contains(b)?[]:glift.sgf.allSgfCoordsToPoints(this.getAllValues(b))},getComment:function(){return this.contains("C")?this.getOneValue("C"):a.none},getMove:function(){var a=glift.enums.states.BLACK,b=glift.enums.states.WHITE;return this.contains("B")?""===this.getOneValue("B")?{color:a}:{color:a,point:this.getAsPoint("B")}:this.contains("W")?
""===this.getOneValue("W")?{color:b}:{color:b,point:this.getAsPoint("W")}:glift.util.none},matches:function(a){for(var b in a)if(this.contains(b)){var c=a[b];if(0===c.length)return!0;for(var g=this.getAllValues(b),h=0;h<g.length;h++)for(var k=0;k<c.length;k++)if(-1!==g[h].indexOf(c[k]))return!0}return!1},getAllStones:function(){var b=glift.enums.states,c={},f=b.WHITE;c[b.BLACK]=this.getPlacementsAsPoints(b.BLACK);c[f]=this.getPlacementsAsPoints(b.WHITE);b=this.getMove();b!=a.none&&void 0!==b.point&&
c[b.color].push(b.point);return c}}})();
glift.rules.treepath={parseInitPosition:function(a){if(void 0===a)return[];if("number"===glift.util.typeOf(a))a=""+a;else{if("array"===glift.util.typeOf(a))return a;if("string"!==glift.util.typeOf(a))return[]}var c=[],b=0;a=a.split("-");for(var d=0;d<a.length;d++){for(var e=a[d].split("."),f=0;f<e[0]-b;f++)c.push(0);b=e[0];for(f=1;f<e.length;f++)c.push(parseInt(e[f])),b++}return c},flattenMoveTree:function(a){for(var c=[],b=0;b<a.node().numChildren();b++){a.moveDown(b);var d=glift.rules.treepath._flattenMoveTree(a,
[]);a.moveUp();for(var e=0;e<d.length;e++)c.push(d[e])}return c},_flattenMoveTree:function(a,c){void 0===c&&(c=[]);c.push(a.node().getVarNum());for(var b=[],d=0;d<a.node().numChildren();d++){a.moveDown(d);var e=glift.rules.treepath._flattenMoveTree(a,c.slice()),b=b.concat(e);a.moveUp(d)}0==b.length&&b.push(c);return b}};
glift.sgf={colorToToken:function(a){if(a===glift.enums.states.WHITE)return"W";if(a===glift.enums.states.BLACK)return"B";throw"Unknown color-to-token conversion for: "+a;},allSgfCoordsToPoints:function(a){for(var c=[],b=0;b<a.length;b++)c.push(glift.util.pointFromSgfCoord(a[b]));return c},convertFromLabelData:function(a){a=a.split(":");return{point:glift.util.pointFromSgfCoord(a[0]),value:a[1]}},convertFromLabelArray:function(a){for(var c=[],b=0;b<a.length;b++)c.push(glift.sgf.convertFromLabelData(a[b]));
return c},pointToSgfCoord:function(a){return String.fromCharCode(a.x()+97)+String.fromCharCode(a.y()+97)}};
glift.sgf.parse=function(a){var c=/\s|\n/,b=/[A-Z]/,d=1,e=glift.rules.movetree.getInstance(),f=[],g=[],h=[],k="",l="",m=0,q=0,n=function(a){glift.sgf.parseError(m,q,l,a)},r=function(){var a=f.join("");f=[];return a},p=function(){0<k.length&&(e.properties().add(k,g),g=[],k="")};(function(){for(var s=0;s<a.length;s++)if(q++,l=a.charAt(s),"\n"===l&&3!==d)m++,q=0;else switch(d){case 1:"("===l||c.test(l)?h.push(e.node().getNodeNum()):";"===l?d=4:c.test(l)||n("Unexpected character");break;case 2:b.test(l)?
(f.push(l),2<f.length&&n("Expected: length two proprety. Found: "+f)):"["===l?(k=r(),void 0===glift.sgf.allProperties[k]&&n("Unknown property: "+k),d=3):c.test(l)?n("Unexpected whitespace in Property"):n("Unexpected character");break;case 3:"]"===l&&"\\"===f[f.length-1]?f.push(l):"]"===l?(g.push(r()),d=4):f.push(l);break;case 4:if(b.test(l))p(),f.push(l),d=2;else if("["===l)0<k.length?d=3:n("Unexpected token.  Orphan property data.");else if("("===l)p(),h.push(e.node().getNodeNum());else if(")"===
l){p();if(0===h.length){for(;0!==e.node().getNodeNum();)e.moveUp();return e}for(var t=h.pop();e.node().getNodeNum()!==t;)e.moveUp()}else";"===l?(p(),e.addNode()):c.test(l)||n("Unknown token");break;default:n("Fatal Error: Unknown State!")}0!==e.node().getNodeNum()&&n("Expected to end up at start.")})();return e};glift.sgf.parseError=function(a,c,b,d){a="SGF Parsing Error: At line ["+a+"], column ["+c+"], curchar ["+b+"], "+d;glift.util.logz(a);throw a;};
glift.sgf.allProperties={AB:"AB",AE:"AE",AN:"AN",AP:"AP",AR:"AR",AS:"AS",AW:"AW",B:"B",BL:"BL",BM:"BM",BR:"BR",BS:"BS",BT:"BT",C:"C",CA:"CA",CH:"CH",CP:"CP",CR:"CR",DD:"DD",DM:"DM",DO:"DO",DT:"DT",EL:"EL",EV:"EV",EX:"EX",FF:"FF",FG:"FG",GB:"GB",GC:"GC",GM:"GM",GN:"GN",GW:"GW",HA:"HA",HO:"HO",ID:"ID",IP:"IP",IT:"IT",IY:"IY",KM:"KM",KO:"KO",L:"L",LB:"LB",LN:"LN",LT:"LT",M:"M",MA:"MA",MN:"MN",N:"N",OB:"OB",OH:"OH",OM:"OM",ON:"ON",OP:"OP",OT:"OT",OV:"OV",OW:"OW",PB:"PB",PC:"PC",PL:"PL",PM:"PM",PW:"PW",
RE:"RE",RG:"RG",RO:"RO",RU:"RU",SC:"SC",SE:"SE",SI:"SI",SL:"SL",SO:"SO",SQ:"SQ",ST:"ST",SU:"SU",SZ:"SZ",TB:"TB",TC:"TC",TE:"TE",TM:"TM",TR:"TR",TW:"TW",UC:"UC",US:"US",V:"V",VW:"VW",W:"W",WL:"WL",WR:"WR",WS:"WS",WT:"WT"};glift.controllers={};
(function(){glift.controllers.base=function(){return new a};var a=function(){this.sgfString="";this.initialPosition=[];this.problemConditions={};this.goban=this.movetree=this.treepath=void 0};a.prototype={initOptions:function(a){if(void 0===a)throw"Options is undefined!  Can't create controller";this.sgfString=a.sgfString||"";this.initialPosition=a.initialPosition||[];this.problemConditions=a.problemConditions||void 0;this.extraOptions(a);this.initialize();return this},extraOptions:function(a){},
addStone:function(a,b){throw"Not Implemented";},recordCaptures:function(a){this.currentMoveNumber++;this.captureHistory.push(a);return this},initialize:function(){var a=glift.rules;this.treepath=a.treepath.parseInitPosition(this.initialPosition);this.currentMoveNumber=this.treepath.length;this.movetree=a.movetree.getFromSgf(this.sgfString,this.treepath);a=a.goban.getFromMoveTree(this.movetree,this.treepath);this.goban=a.goban;this.captureHistory=a.captures;return this},getEntireBoardState:function(){return glift.rules.intersections.getFullBoardData(this.movetree,
this.goban,this.problemConditions)},getNextBoardState:function(){return glift.rules.intersections.nextBoardData(this.movetree,this.getCaptures(),this.problemConditions)},getCaptures:function(){return 0===this.captureHistory.length?{BLACK:[],WHITE:[]}:this.captureHistory[this.currentMoveNumber-1]},canAddStone:function(a,b){return this.goban.placeable(a,b)},getCurrentPlayer:function(){return this.movetree.getCurrentPlayer()},getIntersections:function(){return this.movetree.getIntersections()},nextMove:function(a){if(void 0!==
this.treepath[this.currentMoveNumber]&&(void 0===a||this.treepath[this.currentMoveNumber]===a))this.movetree.moveDown(this.treepath[this.currentMoveNumber]);else if(a=void 0===a?0:a,0<=a&&a<=this.movetree.nextMoves().length-1)this.setNextVariation(a),this.movetree.moveDown(a);else return glift.util.none;a=this.goban.loadStonesFromMovetree(this.movetree);this.recordCaptures(a);return this.getNextBoardState()},prevMove:function(){if(0===this.currentMoveNumber)return glift.util.none;var a=this.getCaptures(),
b=this.movetree.properties().getAllStones();this.captureHistory=this.captureHistory.slice(0,this.currentMoveNumber-1);this.goban.unloadStones(b,a);this.currentMoveNumber=0===this.currentMoveNumber?this.currentMoveNumber:this.currentMoveNumber-1;this.movetree.moveUp();return glift.rules.intersections.previousBoardData(this.movetree,b,a,this.problemConditions)},setNextVariation:function(a){this.treepath=this.treepath.slice(0,this.currentMoveNumber);this.treepath.push(a%this.movetree.node().numChildren());
return this}}})();
(function(){glift.controllers.gameViewer=function(c){var b=glift.util.beget(glift.controllers.base()),b=glift.util.setMethods(b,a);b.initOptions(c);return b};var a={extraOptions:function(a){},addStone:function(a,b){var d=this._possibleNextMoves(),e=a.toString()+"-"+b;return void 0===d[e]?glift.util.none:this.nextMove(d[e])},getNextVariationNumber:function(){return this.currentMoveNumber>this.treepath.length||void 0===this.treepath[this.currentMoveNumber]?0:this.treepath[this.currentMoveNumber]},moveUpVariations:function(){return this.setNextVariation((this.getNextVariationNumber()+
1)%this.movetree.node().numChildren())},moveDownVariations:function(){return this.setNextVariation((this.getNextVariationNumber()-1+ +this.movetree.node().numChildren())%this.movetree.node().numChildren())},toBeginning:function(){this.movetree=this.movetree.getTreeFromRoot();this.goban=glift.rules.goban.getFromMoveTree(this.movetree,[]).goban;this.captureHistory=[];this.currentMoveNumber=0;return this.getEntireBoardState()},toEnd:function(){for(;this.nextMove()!==glift.util.none;);return this.getEntireBoardState()},
_possibleNextMoves:function(){for(var a={},b=this.movetree.nextMoves(),d=0;d<b.length;d++){var e=b[d];a[(void 0!==e.point?e.point.toString():"PASS")+"-"+e.color]=d}return a}}})();
(function(){glift.controllers.staticProblem=function(c){var b=glift.util.beget(glift.controllers.base()),b=glift.util.setMethods(b,a);b.initOptions(c);return b};var a={reload:function(){this.initialize()},addStone:function(a,b){var d=glift.enums.problemResults,e=d.CORRECT,f=d.INCORRECT,g=d.INDETERMINATE,d=d.FAILURE,h=this.goban.addStone(a,b);if(h.successful)d={},d[b]=h.captures,this.recordCaptures(d);else return{result:d};d=this.movetree.findNextMove(a,b);if(d===glift.util.none)return this.movetree.addNode(),
this.movetree.properties().add(glift.sgf.colorToToken(b),a.toSgfCoord()),e=this.getNextBoardState(),e.result=f,e;this.movetree.moveDown(d);d=glift.rules.problems.isCorrectPosition(this.movetree,this.problemConditions);if(d===e||d==f)return e=this.getNextBoardState(),e.result=d,e;if(d===g){f=this.getNextBoardState();e=glift.math.getRandomInt(0,this.movetree.node().numChildren()-1);this.movetree.moveDown(e);e=this.movetree.properties().getMove();h=this.goban.addStone(e.point,e.color);d={};d[e.color]=
h.captures;this.recordCaptures(d);e=this.getNextBoardState();for(b in f.stones)for(d=0;d<f.stones[b].length;d++)e.stones[b].push(f.stones[b][d]);e.result=g;return e}throw"Unexpected result output: "+d;}}})();
glift.bridge={setDisplayState:function(a,c,b){c.intersections().clearMarks();a.displayDataType===glift.enums.displayDataTypes.FULL&&c.intersections().clearAll();for(var d in a.stones)for(var e=0;e<a.stones[d].length;e++){var f=a.stones[d][e];c.intersections().setStoneColor(f,d)}d={};glift.bridge.shouldShowNextMoves(a,b)&&(d=glift.bridge.variationMapping(a.nextMoves));b=glift.enums.marks;for(var g in a.marks)for(e=0;e<a.marks[g].length;e++)f=a.marks[g][e],g===b.LABEL?void 0!==d[f.point.toString()]?
(c.intersections().addMarkPt(f.point,b.VARIATION_MARKER,f.value),delete d[f.point.toString()]):c.intersections().addMarkPt(f.point,b.LABEL,f.value):c.intersections().addMarkPt(f,g);e=1;g=glift.bridge.variationMapping(a.correctNextMoves);for(var h in d)f=d[h],f in g?c.intersections().addMarkPt(f,b.CORRECT_VARIATION,e):c.intersections().addMarkPt(f,b.VARIATION_MARKER,e),e+=1;a.lastMove&&(a.lastMove!==glift.util.none&&void 0!==a.lastMove.point)&&(a=a.lastMove,c.intersections().addMarkPt(a.point,b.STONE_MARKER))},
shouldShowNextMoves:function(a,c){return a.nextMoves&&(1<a.nextMoves.length&&c===glift.enums.showVariations.MORE_THAN_ONE||1<=a.nextMoves.length&&c===glift.enums.showVariations.ALWAYS)},variationMapping:function(a){for(var c={},b=0;b<a.length;b++){var d=a[b];void 0!==d.point&&(c[d.point.toString()]=d.point)}return c}};
glift.bridge.getCropFromMovetree=function(a){var c=glift.displays.bboxFromPts,b=glift.util.point,d=glift.enums.boardRegions,e=a.getIntersections()-1,f=Math.ceil(e/2),g={},h={},k=0;g[d.TOP_LEFT]=c(b(0,0),b(f+1,f+1));g[d.TOP_RIGHT]=c(b(f-1,0),b(e,f+1));g[d.BOTTOM_LEFT]=c(b(0,f-1),b(f+1,e));g[d.BOTTOM_RIGHT]=c(b(f-1,f-1),b(e,e));a.recurseFromRoot(function(a){a=a.properties().getAllStones();for(var b in a)for(var c=a[b],d=0;d<c.length;d++){var e=c[d];k+=1;for(var f in g)g[f].contains(e)&&(void 0===h[f]&&
(h[f]=[]),h[f].push(e))}});return glift.bridge._getRegionFromTracker(h,k)};glift.bridge._getRegionFromTracker=function(a,c){var b=[],d;for(d in a){if(a[d].length===c)return d;b.push(d)}if(2!==b.length)return glift.enums.boardRegions.ALL;var b=glift.util.intersection(glift.util.regions.getComponents(b[0]),glift.util.regions.getComponents(b[1])),e;for(e in b)return e;return glift.boardRegions.ALL};glift.widgets={};
glift.widgets.baseWidget=function(a){a.enableFastClick&&glift.global.enableFastClick();return(new glift.widgets._BaseWidget(glift.widgets.options.setDefaults(a,"base"))).draw()};glift.widgets._BaseWidget=function(a){this.options=a;this.wrapperDiv=a.divId;this.controller=a.controllerFunc(a);this.iconBar=this.display=void 0};
glift.widgets._BaseWidget.prototype={draw:function(){this.divInfo=glift.displays.gui.splitDiv(this.wrapperDiv,this.options.useCommentBar?this.options.splitsWithComments:this.options.splitsWithoutComments,"horizontal");this.goboxDivId=this.divInfo[0].id;this._setNotSelectable(this.goboxDivId);this.options.boardRegion=this.options.boardRegionType===glift.enums.boardRegions.AUTO?glift.bridge.getCropFromMovetree(this.controller.movetree):this.options.boardRegionType;this.options.divId=this.goboxDivId;
this.display=glift.displays.create(this.options);var a=$("#"+this.goboxDivId).width();this.options.useCommentBar&&(this.commentBoxId=this.divInfo[1].id,this._setNotSelectable(this.commentBoxId),this._createCommentBox(a));this.iconBarId=this.options.useCommentBar?this.divInfo[2].id:this.divInfo[1].id;this._setNotSelectable(this.iconBarId);this._createIconBar(a);this._initStoneActions();this._initIconActions();this._initKeyHandlers();this.applyBoardData(this.controller.getEntireBoardState());return this},
_setNotSelectable:function(a){$("#"+a).css({"-webkit-touch-callout":"none","-webkit-user-select":"none","-khtml-user-select":"none","-moz-user-select":"moz-none","-ms-user-select":"none","user-select":"none","-webkit-highlight":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)"});return this},_createCommentBox:function(a){this.commentBox=glift.displays.gui.commentBox(this.commentBoxId,this.display.width(),a,this.options.theme,void 0!==this.options.goBoardBackground)},_createIconBar:function(a){a=
(a-this.display.width())/2;this.iconBar=glift.displays.gui.iconBar({themeName:this.options.themeName,divId:this.iconBarId,vertMargin:5,horzMargin:a,icons:this.options.icons})},_initIconActions:function(){var a=this,c=this.options.actions.icons,b;for(b in c){c[b].mouseover=c[b].mouseover||function(a,b){var c=a.iconBar.iconId(b);d3.select("#"+c).attr("fill","red")};c[b].mouseout=c[b].mouseout||function(a,b){var c=a.iconBar.iconId(b);d3.select("#"+c).attr("fill",a.iconBar.theme.icons.DEFAULT.fill)};
for(var d in c[b])(function(c,d,g){a.iconBar.setEvent(c,b,function(){g(a,d)})})(d,b,c[b][d])}},_initStoneActions:function(){var a=this.options.actions.stones,c=this,b;for(b in a)(function(a,b){c.display.intersections().setEvent(a,function(a){b(c,a)})})(b,a[b])},_initKeyHandlers:function(){var a=this;this.keyHandlerFunc=function(c){if((c=glift.keyMappings.codeToName(c.which))&&void 0!==a.options.keyMapping[c]){c=a.options.keyMapping[c].split(".");for(var b=a.options.actions[c[0]],d=1;d<c.length;d++)b=
b[c[d]];b(a)}};$("body").keydown(this.keyHandlerFunc)},applyBoardData:function(a,c){a&&a!==glift.util.none&&(this.setCommentBox(a),glift.bridge.setDisplayState(a,this.display,this.options.showVariations))},setCommentBox:function(a){this.commentBox&&(a.comment&&a.comment!==glift.util.none?this.commentBox.setText(a.comment):this.commentBox.clearText());return this},reload:function(){this.controller.reload();this.correctness=void 0;this.iconBar.destroyTempIcons();this.applyBoardData(this.controller.getEntireBoardState())},
redraw:function(){this.correctness=void 0;this.destroy();this.draw()},destroy:function(){$("#"+this.wrapperDiv).empty();void 0!==this.keyHandlerFunc&&$("body").unbind("keydown",this.keyHandlerFunc);this.display=this.keyHandlerFunc=void 0}};glift.widgets.basicProblem=function(a){a=glift.widgets.options.setDefaults(a,"problem");a=glift.widgets.options.setDefaults(a,"base");0<a.sgfStringList.length&&(a.sgfString=a.sgfString||a.sgfStringList[0]);return glift.widgets.baseWidget(a)};
glift.widgets.options={setDefaults:function(a,c){var b=glift.widgets.options[c||"base"],d;for(d in b)if(void 0===a[d])if("array"===glift.util.typeOf(b[d])){a[d]=[];for(var e=0;e<b[d].length;e++)a[d].push(b[d][e])}else a[d]=b[d];glift.widgets.options.setDefaultActions(a,b);return a},setDefaultActions:function(a,c){for(var b in c.actions)void 0===a.actions[b]&&(a.actions[b]=c.actions[b]);for(var d in c.actions.stones)void 0===a.actions.stones[d]&&(a.actions.stones[d]=c.actions.stones[d]);for(var e in c.actions.icons){void 0===
a.actions.icons[e]&&(a.actions.icons[e]=c.actions.icons[e]);for(var f in c.actions.icons[e])void 0===a.actions.icons[e][f]&&(a.actions.icons[e][f]=c.actions.icons[e][f])}}};
glift.widgets.options.base={controllerFunc:glift.controllers.gameViewer,sgfString:"",divId:"glift_display",goBoardBackground:"",displayConfig:{},enableFastClick:!0,theme:"DEFAULT",boardRegionType:glift.enums.boardRegions.ALL,showVariations:glift.enums.showVariations.MORE_THAN_ONE,useCommentBar:!0,splitsWithComments:[0.7,0.2],splitsWithoutComments:[0.9],icons:["start","end","arrowleft","arrowright"],keyMapping:{ARROW_LEFT:"icons.arrowleft.click",ARROW_RIGHT:"icons.arrowright.click"},actions:{stones:{click:function(a,
c){var b=a.controller.getCurrentPlayer(),b=a.controller.addStone(c,b);a.applyBoardData(b)},mouseover:function(a,c){var b={BLACK:"BLACK_HOVER",WHITE:"WHITE_HOVER"},d=a.controller.getCurrentPlayer();a.controller.canAddStone(c,d)&&a.display.intersections().setStoneColor(c,b[d])},mouseout:function(a,c){var b=a.controller.getCurrentPlayer();a.controller.canAddStone(c,b)&&a.display.intersections().setStoneColor(c,"EMPTY")}},icons:{start:{click:function(a){a.applyBoardData(a.controller.toBeginning())}},
end:{click:function(a){a.applyBoardData(a.controller.toEnd())}},arrowright:{click:function(a){a.applyBoardData(a.controller.nextMove())}},arrowleft:{click:function(a){a.applyBoardData(a.controller.prevMove())}}}}};
glift.widgets.options.problem={sgfStringList:[],problemIndex:0,problemConditions:{GB:[],C:["Correct","is correct"]},controllerFunc:glift.controllers.staticProblem,boardRegionType:glift.enums.boardRegions.AUTO,icons:["play","refresh","roadmap","checkbox"],useCommentBar:!1,showVariations:glift.enums.showVariations.NEVER,keyMapping:{},actions:{stones:{click:function(a,c){var b=a.controller.getCurrentPlayer(),b=a.controller.addStone(c,b),d=glift.enums.problemResults;b.result!==d.FAILURE&&(a.applyBoardData(b),
void 0===a.correctness&&(b.result===d.CORRECT?(a.iconBar.addTempIcon("check",a.iconBar.getIcon("checkbox").newBbox,"#0CC"),a.correctness=d.CORRECT):b.result==d.INCORRECT&&(a.iconBar.addTempIcon("cross",a.iconBar.getIcon("checkbox").newBbox,"red"),a.correctness=d.INCORRECT)))}},icons:{play:{click:function(a){if(0<a.options.sgfStringList.length){a.options.problemIndex=(a.options.problemIndex+1)%a.options.sgfStringList.length;a.options.sgfString=a.options.sgfStringList[a.options.problemIndex];a.controller=
glift.controllers.staticProblem(a.options);var c=glift.rules.movetree.getFromSgf(a.options.sgfString);a.options.boardRegionType===glift.enums.boardRegions.AUTO&&glift.bridge.getCropFromMovetree(c)!==a.options.boardRegion?a.redraw():(a.reload(),a.reload())}}},refresh:{click:function(a){a.reload()}},roadmap:{click:function(a){a.problemControllor=a.controller;a.problemOptions=a.options;a.destroy();a.options=glift.widgets.options.setDefaults({divId:a.options.divId,theme:a.options.theme,sgfString:a.options.sgfString,
showVariations:glift.enums.showVariations.ALWAYS,problemConditions:glift.widgets.options.problem.problemConditions,boardRegionType:glift.enums.boardRegions.AUTO,icons:["start","end","arrowleft","arrowright","undo"],actions:{icons:{undo:{click:function(a){a.destroy();a.options=a.problemOptions;a.controller=a.problemControllor;a.draw()}}}}},"base");a.controller=glift.controllers.gameViewer(a.options);a.draw()}}}}};
